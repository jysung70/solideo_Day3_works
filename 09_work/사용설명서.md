# 디지털 서비스 운영 리포트 사용설명서

## 1. 개요
- `report_generator.py`는 구조화된 JSON(`report_data.json`)을 읽어 `report.html` 형식의 시각 리포트를 생성합니다.
- 보고서는 Chart.js, 반응형 레이아웃, 표·카드 컴포넌트를 포함하여 PC/모바일에서 바로 열 수 있습니다.
- 본 설명서는 데이터 편집부터 보고서 배포까지의 전체 흐름을 안내합니다.

## 2. 구성 파일
| 파일 | 설명 |
| --- | --- |
| `report_generator.py` | JSON을 HTML 리포트로 변환하는 Python 스크립트.
| `report_data.json` | 리포트에 들어갈 원천 데이터. UTF-8(BOM 허용) 형식.
| `report.html` | 생성된 결과물. 웹 브라우저에서 열어 확인.

## 3. 입력 JSON 구조
| 루트 키 | 타입 | 세부 설명 |
| --- | --- | --- |
| `title` | 문자열 | 보고서 제목. HTML `<title>`과 헤더에 반영.
| `date` | ISO8601 문자열 | `YYYY-MM-DD` 형식 권장. 자동으로 `YYYY년 MM월 DD일`로 변환됨.
| `summary` | 객체 | 핵심 지표 카드. `total_services`, `new_services`, `improved_services`, `user_satisfaction` 포함.
| `departments` | 배열 | 부처별 현황. 각 항목은 `name`, `services`, `users`, `satisfaction`, `budget_used` 필드 사용.
| `monthly_stats` | 배열 | 월별 이용 추이. `month`, `users`, `services`로 구성되며 그래프 & 표에 동시 반영.
| `issues` | 배열(문자열) | 주요 이슈 목록.
| `next_steps` | 배열(문자열) | 향후 조치 계획.

> **TIP**: 수치 필드에는 정수나 실수를 넣으면 자동으로 천 단위 콤마 및 소수점(필요 시 한 자리) 포맷을 적용합니다.

## 4. 실행 방법
```bash
# 기본값: report_data.json -> report.html
python3 report_generator.py

# 다른 입력/출력 경로 지정
python3 report_generator.py path/to/data.json -o output/report_q3.html
```
- Windows PowerShell에서는 `python` 명령을 사용하면 됩니다.
- 실행 결과 예: `보고서가 생성되었습니다: /absolute/path/report.html`

## 5. 보고서 확인 및 배포
1. 생성된 `report.html`을 브라우저로 열어 수치/표/그래프가 올바른지 확인합니다.
2. Chart.js CDN과 Google Fonts를 사용하므로 오프라인 배포 시에는 해당 스크립트/폰트를 로컬에 호스팅하는 것이 좋습니다.
3. 문서 번호(`문서번호: GOV-DS-YYYYMMDD`)는 실행 시점의 날짜를 기준으로 자동 부여됩니다.

## 6. 데이터 업데이트 절차
1. `report_data.json`을 편집기에서 열고 최신 지표로 값들을 교체합니다.
2. 월별 실적이 추가되면 `monthly_stats` 배열에 객체를 추가합니다.
3. 부처 목록이 늘어나도 표가 자동으로 확장되므로 추가 행만 넣으면 됩니다.
4. 이슈/향후 조치 항목은 배열에 문자열을 추가/삭제하여 관리합니다.

## 7. 커스터마이징 가이드
- **스타일 변경**: `report_generator.py` 상단 `STYLE_BLOCK`에서 CSS 변수(`--primary`, `--accent` 등)나 레이아웃을 수정합니다.
- **요약 카드 항목 추가**: `build_summary_cards` 함수의 `mapping` 리스트에 원하는 지표를 추가하면 됩니다.
- **외부 라이브러리**: `render_report` 하단에서 Chart.js CDN 주소를 변경하거나 자체 호스팅 주소로 바꿀 수 있습니다.

## 8. 문제 해결 체크리스트
| 증상 | 원인/해결 |
| --- | --- |
| `JSONDecodeError` | JSON 문법 오류. 쉼표/따옴표/괄호를 확인하고 VS Code, `jq` 등으로 검증하세요. |
| 한글 깨짐 | 파일 인코딩이 UTF-8이 아닌 경우. `UTF-8 with BOM`으로 저장 후 다시 실행. |
| 그래프 데이터 비어 있음 | `monthly_stats`가 비어 있거나 키 이름이 틀린 경우. `month/users/services` 키를 확인하세요. |
| 수치 포맷이 이상함 | 숫자가 문자열로 저장된 경우. 정수/실수형으로 입력해야 콤마/소수점 처리가 됩니다. |

## 9. 배포 모범 사례
- 리포트 승인 프로세스에 맞춰 출력 파일명을 `report_YYYYQn.html` 등으로 버전 관리하세요.
- Git 저장소에 `report_data.json`의 수정 히스토리를 남겨 데이터 출처를 추적합니다.
- 정기 리포트 자동화를 원하면 CI 작업에서 `python3 report_generator.py`를 실행하도록 설정하고 결과물을 아티팩트로 보관하세요.
