# 사용 설명서

## 1. 개요
- `code.py`는 주민등록번호 검증, 민감 정보 마스킹, 로그 통계 분석을 한 번에 처리할 수 있는 경량 도구 모음입니다.
- 각 함수는 독립적으로 동작하므로 필요한 기능만 선택해 사용할 수 있습니다.
- 본 문서는 Python 환경에서 함수를 직접 실행하는 방법을 중심으로 설명합니다.

## 2. 환경 준비
1. Python 3.10 이상이 설치되어 있는지 확인합니다.
2. (선택) 프로젝트 폴더에서 가상환경을 생성하고 활성화합니다.
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows PowerShell은 .venv\Scripts\Activate.ps1
   ```
3. 외부 패키지는 사용하지 않으므로 추가 설치 단계는 없습니다.

## 3. 파일 구성
| 파일 | 설명 |
| --- | --- |
| `code.py` | 핵심 기능 3가지를 구현한 모듈 |
| `DOCUMENTATION.md` | 함수 사양 요약 및 설계 의도 |
| `사용한 프롬프트 텍스트 파일.md` | 작업 시 참고한 프롬프트 기록 |

## 4. 사용 방법
### 4.1 Python REPL 혹은 스크립트에서 임포트
```python
from code import validate_korean_id, mask_sensitive_data, analyze_log_file
```

### 4.2 주민등록번호 검증 (`validate_korean_id`)
1. 하이픈 포함 여부와 무관하게 13자리를 문자열로 전달합니다.
2. 반환값이 `True`면 유효, `False`면 형식 오류 또는 체크섬 불일치를 의미합니다.
```python
if validate_korean_id("800101-1234567"):
    print("유효한 주민등록번호입니다.")
else:
    print("잘못된 번호입니다.")
```
> **Tip**: 길이 검증도 포함되어 있으므로 사용자 입력을 그대로 넘겨도 됩니다.

### 4.3 민감 정보 마스킹 (`mask_sensitive_data`)
1. `pattern_type`에 `'phone'`, `'email'`, `'card'` 중 하나를 지정합니다.
2. 반환된 문자열에서 해당 영역만 `*`로 치환되어 표시됩니다.
```python
masked_phone = mask_sensitive_data("주문자: 010-1234-5678", "phone")
masked_email = mask_sensitive_data("이메일: user@example.com", "email")
masked_card = mask_sensitive_data("카드번호 1234 5678 9012 3456", "card")
```
> **주의**: 한 번에 하나의 패턴만 처리하므로 여러 유형을 가리려면 함수를 반복 호출하세요.

### 4.4 로그 파일 분석 (`analyze_log_file`)
1. 텍스트 로그 파일 경로를 인자로 전달합니다.
2. 반환값은 `total`, `info`, `warning`, `error`, `critical` 키를 갖는 딕셔너리입니다.
```python
stats = analyze_log_file("./logs/app.log")
print(f"총 {stats['total']}줄 중 ERROR {stats['error']}건")
```
> **전제**: 로그 한 줄에 한 개의 레벨 문자열(INFO/WARNING/ERROR/CRITICAL)만 포함된다는 가정입니다.

## 5. 예제 워크플로
```python
from code import validate_korean_id, mask_sensitive_data, analyze_log_file

if not validate_korean_id("9001011234567"):
    raise ValueError("입력값 검증 실패")

safe_text = mask_sensitive_data("전화 010.4321.8765, 메일 test@demo.com", "phone")
safe_text = mask_sensitive_data(safe_text, "email")

stats = analyze_log_file("sample.log")
print(safe_text, stats)
```

## 6. 수동 테스트 체크리스트
- 잘못된 자리수 주민등록번호 입력 시 `False`가 반환되는지 확인.
- `mask_sensitive_data`에 지원하지 않는 유형을 넣었을 때 원본이 유지되는지 확인.
- 로그 파일에 특정 레벨이 하나도 없을 때 해당 카운트가 0으로 남는지 확인.

## 7. 문제 해결 가이드
- **ValueError/TypeError**: 함수는 문자열 입력을 기대하므로 숫자 타입을 직접 전달하지 마세요.
- **파일 경로 오류**: `analyze_log_file` 사용 시 상대 경로 기준이 실행 디렉터리이므로 `Path.resolve()`로 절대경로를 넘기는 것도 방법입니다.
- **마스킹 누락**: `pattern_type` 철자를 재확인하고, 정규식 패턴에 맞게 문자열을 정규화(공백/구분자 제거)하세요.

## 8. 확장 아이디어
1. `mask_sensitive_data`에 주민등록번호·여권번호 패턴을 추가.
2. `analyze_log_file` 결과를 JSON/CSV로 내보내는 래퍼 함수 작성.
3. CLI 인터페이스(예: `python -m code mask --type phone "텍스트"` )를 추가해 비개발자도 사용할 수 있도록 확장.
